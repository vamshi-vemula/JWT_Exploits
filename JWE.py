from jwcrypto import jwe, jwk
import json

# Load the RSA public key from file
with open('public.pem', 'rb') as f:
    public_key = jwk.JWK.from_pem(f.read())

# Define the payload to be encrypted
payload = json.dumps({"user": "admin"})

# Use JWCrypto to encrypt the JWE token with the specified header, key, and payload
jwe_token = jwe.JWE(payload, recipient=public_key, protected={"alg": "RSA-OAEP", "enc": "A192GCM"})
jwe_token.add_recipient(public_key)
encrypted_token = jwe_token.serialize()

#Getting all five parts
encrypted_token = json.loads(encrypted_token)
ciphertext= encrypted_token["ciphertext"]
iv=encrypted_token["iv"]
protected=encrypted_token["protected"]
reciepts=encrypted_token["recipients"][0]["encrypted_key"]
tag=encrypted_token["tag"]

#Printing Token
print(protected+"."+reciepts+"."+iv+"."+ciphertext+"."+tag)